//
//  ExtWSState.swift
//  ExtWSClient
//
//  Created by d.kotina on 01.09.2025.
//

import Foundation

/// Состояние WebSocket-транспорта.
///
/// Это перечисление описывает жизненный цикл соединения, включая промежуточные
/// состояния и специальные случаи (например, ожидание сети или повторное подключение).
///
/// Поддерживает сравнение (`Equatable`) и безопасен для использования
/// в конкурентной среде (`Sendable`).
///
/// - Cases:
///   - `idle`: Транспорт инициализирован, соединение ещё не начиналось.
///   - `connecting`: Выполняется установка соединения (TCP/TLS + WebSocket handshake).
///   - `open`: Соединение установлено и готово к обмену сообщениями.
///   - `closing`: Инициировано закрытие соединения.
///   - `closed`: Соединение завершено и не активно.
///   - `waitingNetwork`: Ожидание доступности сети (например, при восстановлении соединения).
///   - `retrying(after:)`: Попытка повторного подключения будет выполнена через заданный интервал (в секундах).
public enum ExtWSState: Equatable, Sendable {
    /// Транспорт инициализирован, но подключение ещё не выполнялось.
    case idle

    /// Устанавливается соединение (TCP/TLS + WebSocket handshake).
    case connecting

    /// Соединение открыто и готово к работе.
    case open

    /// Инициировано закрытие соединения.
    case closing

    /// Соединение полностью закрыто.
    case closed

    /// Ожидание появления сети (например, при восстановлении соединения).
    case waitingNetwork

    /// Запланирован повтор соединения через указанный интервал (секунды).
    ///
    /// - Parameter after: Интервал в секундах до следующей попытки подключения.
    case retrying(after: TimeInterval)
}

